<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Digital ClassRoom</title>
  <style>
    /* Your existing CSS styles go here... (I've kept them the same) */
    @import url('https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600&display=swap');
    body{font-family:'Poppins',-apple-system,BlinkMacSystemFont,"Segoe UI",sans-serif;background:linear-gradient(135deg,#667eea 0%,#764ba2 100%);margin:0;color:#444;line-height:1.6;min-height:100vh;overflow-x:hidden}@keyframes fadeIn{from{opacity:0;transform:translateY(20px)}to{opacity:1;transform:translateY(0)}}.page{display:none}#login-page{display:block}.login-container{width:90%;max-width:400px;margin:100px auto;padding:40px;background:rgba(255,255,255,0.95);backdrop-filter:blur(10px);box-shadow:0 8px 32px 0 rgba(31,38,135,0.37);border-radius:15px;text-align:center;border:1px solid rgba(255,255,255,0.18);animation:fadeIn 0.6s ease-out}.login-container h2{color:#333;margin-bottom:25px}.login-container input{box-sizing:border-box;width:100%;padding:14px;margin:10px 0 15px 0;border:1px solid #ccc;border-radius:8px;transition:all 0.3s ease}.login-container input:focus{outline:none;border-color:#667eea;box-shadow:0 0 0 3px rgba(102,126,234,0.2)}.login-btn{width:100%;padding:14px;color:white;border:none;border-radius:8px;cursor:pointer;font-size:1rem;font-weight:600;background:linear-gradient(90deg,#667eea 0%,#764ba2 100%);transition:transform 0.2s ease,box-shadow 0.2s ease}.login-btn:hover{transform:translateY(-2px);box-shadow:0 4px 20px rgba(0,0,0,0.15)}.admin-link-container{margin-top:20px}.admin-link{color:#667eea;text-decoration:none;font-size:0.9rem;font-weight:600;transition:color 0.3s ease}.admin-link:hover{color:#764ba2}header{background:rgba(255,255,255,0.9);backdrop-filter:blur(10px);color:#333;padding:1rem;text-align:center;box-shadow:0 2px 10px rgba(0,0,0,0.1);position:sticky;top:0;z-index:100}header h1{margin:0;font-weight:600}nav a{color:#555;margin:0 15px;text-decoration:none;font-weight:600;cursor:pointer;transition:color 0.3s ease}nav a:hover{color:#667eea}.card-container{display:flex;flex-wrap:wrap;justify-content:center;padding:20px;gap:25px;animation:fadeIn 0.6s ease-out forwards;animation-delay:0.2s;opacity:0}.card{background:#fff;border-radius:15px;box-shadow:0 8px 24px rgba(0,0,0,0.1);padding:25px;text-align:center;flex:1 1 300px;max-width:380px;transition:all 0.3s ease}.card:hover{transform:translateY(-5px);box-shadow:0 12px 28px rgba(0,0,0,0.15)}.card img,.card video,.card audio,.card iframe{max-width:100%;border-radius:8px}.card img,.card video,.card iframe{cursor:pointer;transition:transform 0.2s ease}.card img:hover,.card video:hover,.card iframe:hover{transform:scale(1.05)}.card h3{margin-top:0;color:#333}.overlay{position:fixed;display:none;justify-content:center;align-items:center;top:0;left:0;width:100%;height:100%;background:rgba(0,0,0,0.9);z-index:9999;animation:fadeOverlay 0.4s ease}@keyframes fadeOverlay{from{opacity:0}to{opacity:1}}.overlay img,.overlay video,.overlay iframe{max-width:90%;max-height:90%;border-radius:10px;box-shadow:0 0 20px rgba(255,255,255,0.2);cursor:zoom-out;background:white}.download-btn{display:inline-block;margin-top:15px;padding:10px 20px;background-color:#28a745;color:white;text-decoration:none;border-radius:8px;font-weight:600;transition:all 0.2s ease}.download-btn:hover{background-color:#218838;transform:translateY(-2px);box-shadow:0 4px 15px rgba(0,0,0,0.1)}.site-footer{text-align:center;padding:30px;margin-top:40px;background-color:#343a40;color:#f8f9fa}.site-footer a{color:#ffffff;font-weight:bold;text-decoration:none;transition:opacity 0.3s ease}.site-footer a:hover{opacity:0.8}@media (max-width:600px){header h1{font-size:1.5rem}nav a{margin:0 10px}}
  </style>
</head>
<body>

  <!-- LOGIN PAGE -->
  <div id="login-page" class="page">
    <div class="login-container">
      <h2>Digital ClassRoom</h2>
      <form id="login-form">
        <input type="text" id="name" placeholder="Full Name" required>
        <input type="text" id="branch" placeholder="Branch / Section" required>
        <input type="text" id="rollNumber" placeholder="Roll Number" required>
        <button type="submit" class="login-btn">Login</button>
        <div class="admin-link-container">
          <a href="admin.html" target="_blank" class="admin-link">Admin Login</a>
        </div>
      </form>
    </div>
  </div>

  <!-- MAIN PAGE -->
  <div id="main-page" class="page">
    <header>
      <h1>Welcome to Digital ClassRoom, <span id="welcome-name"></span>!</h1>
      <nav>
        <a id="home-nav-btn">Home</a>
        <a id="logout-btn">Logout</a>
      </nav>
    </header>
    <div class="card-container">
        <div class="card"><h3>Images üñºÔ∏è</h3><img src="https://digitalclassroom01.s3.ap-south-1.amazonaws.com/NotebookLM+Mind+Map.png" alt="Description of Image" class="clickable-media"></div>
        <div class="card"><h3>Audio üéµ</h3><audio controls style="width:100%"><source src="https://digitalclassroom01.s3.ap-south-1.amazonaws.com/AI.m4a" type="audio/mpeg"></audio><a href="https://digitalclassroom01.s3.ap-south-1.amazonaws.com/AI.m4a" class="download-btn" download>Download Audio</a></div>
        <div class="card"><h3>Videos üé¨</h3><video width="100%" class="clickable-media"><source src="https://digitalclassroom01.s3.ap-south-1.amazonaws.com/Demystifying_AI.mp4" type="video/mp4"></video></div>
        <div class="card"><h3>Notes üìò</h3><iframe src="https://digitalclassroom01.s3.ap-south-1.amazonaws.com/AI_notes.pdf" width="100%" height="300px" class="clickable-media" data-type="pdf"></iframe><a href="https://digitalclassroom01.s3.ap-south-1.amazonaws.com/AI_notes.pdf" class="download-btn" download>Download Notes</a></div>
    </div>
    <footer class="site-footer"><p>For any questions, please contact: <a href="mailto:mekadinesh4@gmail.com">mekadinesh4@gmail.com</a></p></footer>
  </div>

  <!-- FULLSCREEN OVERLAY -->
  <div id="fullscreenOverlay" class="overlay">
    <img id="fullscreenImg" src="" style="display:none; width:auto; height:auto;">
    <video id="fullscreenVideo" controls style="display:none;"></video>
    <iframe id="fullscreenPdf" src="" style="display:none; width: 90%; height: 90%; border: none;"></iframe>
  </div>

  <script type="module">
    // Import the functions you need from the SDKs you need
    import { initializeApp } from "https://www.gstatic.com/firebasejs/9.15.0/firebase-app.js";
    import { getDatabase, ref, set, push } from "https://www.gstatic.com/firebasejs/9.15.0/firebase-database.js";

    // Your web app's Firebase configuration
    const firebaseConfig = {
      apiKey: "AIzaSyDYUd_CrvXkzMpg9et6SduiPbo8VaBIu6Q",
      authDomain: "digitalclassroom-2f524.firebaseapp.com",
      projectId: "digitalclassroom-2f524",
      databaseURL: "https://digitalclassroom-2f524-default-rtdb.firebaseio.com/",
      storageBucket: "digitalclassroom-2f524.appspot.com",
      messagingSenderId: "822614894077",
      appId: "1:822614894077:web:6461496b9445addbe46594"
    };

    // Initialize Firebase
    const app = initializeApp(firebaseConfig);
    const database = getDatabase(app);

    // --- DOM Elements ---
    const loginForm = document.getElementById('login-form');
    const logoutBtn = document.getElementById('logout-btn');
    const homeNavBtn = document.getElementById('home-nav-btn');
    const welcomeName = document.getElementById('welcome-name');

    // --- Functions ---
    function showPage(pageId) {
      document.querySelectorAll('.page').forEach(page => page.style.display = 'none');
      const pageToShow = document.getElementById(pageId);
      if (pageToShow) {
        pageToShow.style.display = 'block';
        sessionStorage.setItem('currentPage', pageId);
      }
    }

    function handleLogin(event) {
      event.preventDefault();
      const userDetails = {
        name: document.getElementById('name').value,
        branch: document.getElementById('branch').value,
        rollNumber: document.getElementById('rollNumber').value,
        loginTime: new Date().toLocaleString("en-IN", { timeZone: "Asia/Kolkata" })
      };
      
      const loginsListRef = ref(database, 'logins');
      const newLoginRef = push(loginsListRef);

      set(newLoginRef, userDetails)
        .then(() => {
          console.log("Login data saved successfully.");
          sessionStorage.setItem('userName', userDetails.name);
          welcomeName.textContent = userDetails.name;
          showPage('main-page');
        })
        .catch((error) => {
          console.error("Error saving login data: ", error);
        });
    }

    function logout() {
      document.getElementById('login-form').reset();
      sessionStorage.removeItem('currentPage');
      sessionStorage.removeItem('userName');
      showPage('login-page');
    }

    // --- Event Listeners ---
    loginForm.addEventListener('submit', handleLogin);
    logoutBtn.addEventListener('click', logout);
    homeNavBtn.addEventListener('click', () => showPage('main-page'));

    // --- Fullscreen Logic (Corrected and Verified) ---
    const overlay = document.getElementById('fullscreenOverlay');
    const fullscreenImg = document.getElementById('fullscreenImg');
    const fullscreenVideo = document.getElementById('fullscreenVideo');
    const fullscreenPdf = document.getElementById('fullscreenPdf');
    const mediaElements = document.querySelectorAll('.clickable-media');

    mediaElements.forEach(el => {
      el.addEventListener('click', () => {
        // Hide all fullscreen elements initially
        fullscreenImg.style.display = 'none';
        fullscreenVideo.style.display = 'none';
        fullscreenPdf.style.display = 'none';

        // Show the overlay
        overlay.style.display = 'flex';

        // Determine which element to show
        if (el.tagName === 'IMG') {
          fullscreenImg.src = el.src;
          fullscreenImg.style.display = 'block';
        } else if (el.tagName === 'VIDEO') {
          fullscreenVideo.src = el.querySelector('source').src;
          fullscreenVideo.style.display = 'block';
          fullscreenVideo.play();
        } else if (el.dataset.type === 'pdf') {
          fullscreenPdf.src = el.src;
          fullscreenPdf.style.display = 'block';
        }
      });
    });

    overlay.addEventListener('click', () => {
      overlay.style.display = 'none';
      fullscreenVideo.pause();
      // Clear sources to stop loading/playing in the background
      fullscreenImg.src = '';
      fullscreenVideo.src = '';
      fullscreenPdf.src = '';
    });

    // Restore page on refresh
    window.addEventListener('load', () => {
      const currentPage = sessionStorage.getItem('currentPage');
      const userName = sessionStorage.getItem('userName');
      if (currentPage === 'main-page' && userName) {
        welcomeName.textContent = userName;
        showPage('main-page');
      } else {
        showPage('login-page');
      }
    });
  </script>
</body>
</html>

